import{u as f,r as m,j as e,L as j,F as v,b as N,d as w,V as n}from"./index-Dyj1s5of.js";const k=()=>{const x=f(),[o,i]=m.useState([]),[a,h]=m.useState({name:"",phone:"",email:"",address:"",notes:"",paymentMethod:"cod"});m.useEffect(()=>{const s=JSON.parse(localStorage.getItem("cartItems"))||[];i(s)},[]);const g=s=>{i(s),localStorage.setItem("cartItems",JSON.stringify(s))},u=s=>{const t=o.filter(c=>c._id!==s);g(t),n.success("Item removed")},p=(s,t)=>{const c=o.map(r=>{if(r._id===s){const d=r.quantity+t;return{...r,quantity:d>0?d:1}}return r});g(c)},y=()=>o.reduce((s,t)=>s+t.price*t.quantity,0),l=s=>{h(t=>({...t,[s.target.name]:s.target.value}))},b=async s=>{s.preventDefault();const t=/^\d{11}$/,c=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(!a.name.trim()||a.name.trim().length<3){n.error("Please enter a valid name (min 3 characters).");return}if(!t.test(a.phone)){n.error("Please enter a valid 11-digit phone number.");return}if(!a.address.trim()||a.address.trim().length<10){n.error("Please enter a valid shipping address (min 10 characters).");return}if(a.email&&!c.test(a.email)){n.error("Please enter a valid email address.");return}try{const r=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...a,cartItems:o})}),d=await r.json();r.ok?(n.success("Order placed successfully!"),i([]),localStorage.removeItem("cartItems"),h({name:"",phone:"",email:"",address:"",notes:"",paymentMethod:"cod"}),x("/order-success")):n.error(d.message||"Something went wrong")}catch(r){console.error(r),n.error("Checkout failed")}};return o.length===0?e.jsxs("div",{className:"min-h-screen flex flex-col justify-center items-center bg-gray-100 px-4",children:[e.jsx("h2",{className:"text-3xl font-semibold text-gray-800 mb-4",children:"Your cart is empty"}),e.jsx(j,{to:"/shop",className:"text-white bg-black px-6 py-2 rounded hover:bg-gray-800 transition",children:"Go to Shop"})]}):e.jsx("div",{className:"min-h-screen bg-gray-100 py-10 px-4 md:px-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto bg-white shadow-xl rounded-lg p-6 md:p-10 space-y-8",children:[e.jsxs("div",{className:"relative flex items-center",children:[e.jsx("button",{onClick:()=>x(-1),className:"text-sm md:text-base text-gray-600 hover:text-black border border-gray-300 hover:border-black px-3 py-1 rounded transition",children:"← Back"}),e.jsx("h1",{className:"absolute left-1/2 transform -translate-x-1/2 text-3xl md:text-4xl font-bold text-gray-800",children:"Your Cart"})]}),e.jsx("div",{className:"space-y-6",children:o.map(s=>e.jsxs("div",{className:"flex flex-col md:flex-row justify-between  items-center border rounded-lg p-4 bg-gray-50 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-4 w-full md:w-2/3",children:[e.jsx("img",{src:s.mainImage,alt:s.name,className:"w-20 h-20 object-cover rounded-lg border"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:s.name}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["Rs ",s.price," × ",s.quantity," ="," ",e.jsxs("strong",{children:["Rs ",(s.price*s.quantity).toFixed(2)]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-4 md:mt-0",children:[e.jsx("button",{onClick:()=>p(s._id,-1),className:"p-2 bg-gray-200 hover:bg-gray-300 rounded",children:e.jsx(v,{})}),e.jsx("span",{className:"w-6 text-center font-semibold",children:s.quantity}),e.jsx("button",{onClick:()=>p(s._id,1),className:"p-2 bg-gray-200 hover:bg-gray-300 rounded",children:e.jsx(N,{})}),e.jsx("button",{onClick:()=>u(s._id),className:"text-red-600 hover:text-red-800",title:"Remove",children:e.jsx(w,{})})]})]},s._id))}),e.jsxs("div",{className:"text-right text-lg  font-semibold",children:["Total:"," ",e.jsxs("span",{className:"text-green-700 text-2xl font-bold",children:["Rs ",y().toFixed(2)]}),e.jsx("span",{className:"bg-green-500 flex mt-2 mx-2 w-fit rounded text-white text-right px-3 py-2 font-semibold z-10",children:"Free Delivery"})]}),e.jsxs("div",{children:["Advance Payment on"," ",e.jsx("strong",{className:"text-green-500",children:"0306 6462666"})]}),e.jsxs("div",{className:"border-t pt-8 grid grid-cols-1 md:grid-cols-2 gap-10",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-700",children:"Billing Information"}),e.jsxs("div",{className:"grid gap-4",children:[e.jsx("input",{type:"text",name:"name",placeholder:"Full Name*",value:a.name,onChange:l,className:"border px-4 py-2 rounded outline-none focus:ring-2 focus:ring-black"}),e.jsx("input",{type:"text",name:"phone",placeholder:"Phone Number*",value:a.phone,onChange:l,className:"border px-4 py-2 rounded outline-none focus:ring-2 focus:ring-black"}),e.jsx("input",{type:"email",name:"email",placeholder:"Email (Optional)",value:a.email,onChange:l,className:"border px-4 py-2 rounded outline-none focus:ring-2 focus:ring-black"}),e.jsx("textarea",{name:"address",placeholder:"Shipping Address*. Add street, house number, city, ",rows:3,value:a.address,onChange:l,className:"border px-4 py-2 rounded resize-none outline-none focus:ring-2 focus:ring-black"}),e.jsx("textarea",{name:"notes",placeholder:"Additional Notes (Optional)",rows:2,value:a.notes,onChange:l,className:"border px-4 py-2 rounded resize-none outline-none focus:ring-2 focus:ring-black"})]})]}),e.jsxs("div",{className:"flex flex-col justify-between",children:[e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-700 mb-2",children:"Payment Method"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"paymentMethod",value:"cod",checked:a.paymentMethod==="cod",onChange:l,className:"accent-green-600"}),e.jsx("span",{children:"Cash on Delivery"})]})})]})}),e.jsx("button",{onClick:b,className:"mt-8 bg-green-600 hover:bg-green-700 text-white py-3 px-6 rounded text-lg transition",children:"Place Order"})]})]})]})})};export{k as default};
