import{r as c,j as a,a as p,V as i}from"./index-FzgKAEwF.js";const o="https://hh-clocks-watches-production.up.railway.app",y=()=>{const[h,g]=c.useState([]),[t,l]=c.useState({name:"",price:"",description:"",mainImage:null,mainImagePreview:null,previewImages:[],previewPreviews:[],hasDiscount:!1,discountRate:0,available:0,sold:0,inStock:!0}),[b,m]=c.useState(null),[n,r]=c.useState({name:"",price:"",imagePreview:null,hasDiscount:!1,discountRate:0,available:0}),d=async()=>{const e=await p.get(`${o}/api/shop`);g(e.data)},v=async()=>{try{const e=new FormData;e.append("name",t.name),e.append("price",t.price),e.append("description",t.description),e.append("hasDiscount",t.hasDiscount),e.append("discountRate",t.discountRate),e.append("available",t.available),t.mainImage&&e.append("mainImage",t.mainImage),t.previewImages.forEach(s=>e.append("previewImages",s)),await p.post(`${o}/api/shop`,e,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}),i.success("Item added"),l({name:"",price:"",description:"",mainImage:null,mainImagePreview:null,previewImages:[],previewPreviews:[],hasDiscount:!1,discountRate:0,available:0,sold:0,inStock:!0}),d()}catch{i.error("Failed to add item")}},j=async e=>{try{await p.delete(`${o}/api/shop/${e}`,{withCredentials:!0}),i.success("Item deleted"),d()}catch{i.error("Delete failed")}},w=async e=>{try{await p.put(`${o}/api/shop/${e}`,n,{withCredentials:!0}),i.success("Item updated"),d(),m(null)}catch{i.error("Update failed")}},f=e=>{const s=e.target.files[0];s&&l(u=>({...u,mainImage:s,mainImagePreview:URL.createObjectURL(s)}))},N=e=>{const s=Array.from(e.target.files).slice(0,3),u=s.map(x=>URL.createObjectURL(x));l(x=>({...x,previewImages:s,previewPreviews:u}))};return c.useEffect(()=>{d()},[]),a.jsxs("div",{className:"bg-amber-600 text-white p-6 rounded-xl mx-auto max-w-screen-2xl",children:[a.jsx("h2",{className:"text-3xl font-bold mb-6",children:"Manage Shop"}),a.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 mb-8",children:[a.jsx("input",{type:"text",placeholder:"Item name",value:t.name,onChange:e=>l({...t,name:e.target.value}),className:"p-2 rounded border outline-none text-black"}),a.jsx("input",{type:"text",placeholder:"Price",value:t.price,onChange:e=>l({...t,price:e.target.value}),className:"p-2 rounded border outline-none text-black"}),a.jsx("input",{type:"text",placeholder:"Sold",value:t.sold,onChange:e=>l({...t,sold:e.target.value}),className:"p-2 rounded border outline-none text-black"}),a.jsx("input",{type:"number",placeholder:"Available Stock",value:t.available,onChange:e=>l({...t,available:Number(e.target.value)}),className:"p-2 rounded border outline-none text-black"}),a.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:t.hasDiscount,onChange:e=>l({...t,hasDiscount:e.target.checked})}),"Apply Discount"]}),a.jsx("input",{type:"number",placeholder:"Discount %",value:t.discountRate,disabled:!t.hasDiscount,onChange:e=>l({...t,discountRate:Number(e.target.value)}),className:"p-2 rounded border outline-none text-black"}),a.jsx("textarea",{placeholder:"Description",value:t.description,onChange:e=>l({...t,description:e.target.value}),className:"p-2 rounded border outline-none text-black col-span-full"}),a.jsxs("label",{className:"bg-white text-amber-700 px-4 py-2 rounded cursor-pointer hover:bg-amber-100 text-sm font-medium text-center",children:["Main Image",a.jsx("input",{type:"file",onChange:f,className:"hidden"})]}),t.mainImagePreview&&a.jsx("img",{src:t.mainImagePreview,className:"w-24 h-24 object-cover rounded border"}),a.jsxs("label",{className:"bg-white text-amber-700 px-2 py-2 rounded cursor-pointer hover:bg-amber-100 text-sm font-medium text-center",children:["Preview Images (max 3)",a.jsx("input",{type:"file",onChange:N,className:"hidden",multiple:!0})]}),a.jsx("div",{className:"flex gap-2",children:t.previewPreviews.map((e,s)=>a.jsx("img",{src:e,className:"w-20 h-20 object-cover rounded"},s))}),a.jsx("button",{onClick:v,className:"bg-amber-800 hover:bg-amber-900 text-white py-2 px-2 rounded font-bold cursor-pointer",children:"Add Item"})]}),a.jsx("div",{className:"grid gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5",children:h.map(e=>a.jsxs("div",{className:"bg-white text-black p-4 rounded-lg shadow-md flex flex-col relative",children:[e.hasDiscount&&a.jsxs("div",{className:"absolute top-2 left-2 bg-red-600 text-white text-xs font-semibold px-2 py-1 rounded-full shadow",children:[e.discountRate,"% OFF"]}),b===e._id?a.jsxs(a.Fragment,{children:[a.jsx("input",{value:n.name,onChange:s=>r({...n,name:s.target.value}),className:"w-full font-bold text-lg border rounded px-2 py-1 mb-2"}),a.jsx("input",{value:n.price,onChange:s=>r({...n,price:s.target.value}),className:"w-full text-sm border rounded px-2 py-1"}),a.jsxs("label",{className:"flex items-center gap-2 text-sm mt-2",children:[a.jsx("input",{type:"checkbox",checked:n.hasDiscount,onChange:s=>r({...n,hasDiscount:s.target.checked})}),"Apply Discount"]}),a.jsx("input",{type:"number",value:n.discountRate,onChange:s=>r({...n,discountRate:Number(s.target.value)}),className:"border rounded p-1 text-sm"}),a.jsx("input",{type:"number",value:n.available,onChange:s=>r({...n,available:Number(s.target.value)}),className:"border rounded p-1 text-sm mt-2"}),a.jsxs("div",{className:"flex gap-2 mt-3",children:[a.jsx("button",{onClick:()=>w(e._id),className:"bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-sm",children:"Update"}),a.jsx("button",{onClick:()=>m(null),className:"text-sm text-gray-600 hover:text-black",children:"Cancel"})]})]}):a.jsxs(a.Fragment,{children:[e.mainImage&&a.jsx("img",{src:`${o}${e.mainImage}`,alt:e.name,className:"w-full h-40 object-fill rounded mb-2"}),a.jsx("h3",{className:"font-bold text-lg",children:e.name}),e.hasDiscount?a.jsxs(a.Fragment,{children:[a.jsxs("p",{className:"text-sm text-red-600 line-through",children:["Rs ",e.price]}),a.jsxs("p",{className:"text-sm font-semibold text-green-700",children:["Rs ",e.price-e.price*e.discountRate/100]})]}):a.jsxs("p",{className:"text-sm text-gray-700",children:["Rs ",e.price]}),a.jsxs("p",{className:"text-xs mt-1",children:[" ",a.jsx("span",{className:e.inStock?"text-green-700":"text-red-600",children:e.inStock?`In Stock (${e.available})`:"Out of Stock"})]}),a.jsxs("p",{className:"text-xs text-gray-500",children:["Sold: ",e.sold]}),a.jsxs("div",{className:"mt-auto flex gap-2 pt-4",children:[a.jsx("button",{onClick:()=>{m(e._id),r({name:e.name,price:e.price,hasDiscount:e.hasDiscount,discountRate:e.discountRate,available:e.available})},className:"bg-amber-700 hover:bg-amber-800 text-white px-3 py-1 rounded text-sm",children:"Edit"}),a.jsx("button",{onClick:()=>j(e._id),className:"bg-red-100 text-red-600 hover:bg-red-200 px-3 py-1 rounded text-sm",children:"Delete"})]})]})]},e._id))})]})};export{y as default};
